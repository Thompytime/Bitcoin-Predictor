{"ast":null,"code":"import { parseMetadata } from '@aws-amplify/core/internals/aws-client-utils';\nimport { AmplifyUrl, AmplifyUrlSearchParams } from '@aws-amplify/core/internals/utils';\nimport { composeServiceApi } from '@aws-amplify/core/internals/aws-client-utils/composers';\nimport { parseXmlBody } from '../utils/parsePayload.mjs';\nimport { s3TransferHandler } from '../runtime/s3TransferHandler/fetch.mjs';\nimport 'fast-xml-parser';\nimport '../runtime/s3TransferHandler/xhr.mjs';\nimport 'buffer';\nimport { buildStorageServiceError, map, emptyArrayGuard, deserializeBoolean, deserializeNumber, deserializeTimestamp } from '../utils/deserializeHelpers.mjs';\nimport { assignStringVariables } from '../utils/serializeHelpers.mjs';\nimport { IntegrityError } from '../../../../../errors/IntegrityError.mjs';\nimport { defaultConfig, parseXmlError } from './base.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst listObjectsV2Serializer = (input, endpoint) => {\n  const headers = assignStringVariables({\n    'x-amz-request-payer': input.RequestPayer,\n    'x-amz-expected-bucket-owner': input.ExpectedBucketOwner\n  });\n  const query = assignStringVariables({\n    'list-type': '2',\n    'continuation-token': input.ContinuationToken,\n    delimiter: input.Delimiter,\n    'encoding-type': input.EncodingType,\n    'fetch-owner': input.FetchOwner,\n    'max-keys': input.MaxKeys,\n    prefix: input.Prefix,\n    'start-after': input.StartAfter\n  });\n  const url = new AmplifyUrl(endpoint.url.toString());\n  url.search = new AmplifyUrlSearchParams(query).toString();\n  return {\n    method: 'GET',\n    headers,\n    url\n  };\n};\nconst listObjectsV2Deserializer = async response => {\n  if (response.statusCode >= 300) {\n    // error is always set when statusCode >= 300\n    const error = await parseXmlError(response);\n    throw buildStorageServiceError(error, response.statusCode);\n  } else {\n    const parsed = await parseXmlBody(response);\n    const contents = map(parsed, {\n      CommonPrefixes: ['CommonPrefixes', value => emptyArrayGuard(value, deserializeCommonPrefixList)],\n      Contents: ['Contents', value => emptyArrayGuard(value, deserializeObjectList)],\n      ContinuationToken: 'ContinuationToken',\n      Delimiter: 'Delimiter',\n      EncodingType: 'EncodingType',\n      IsTruncated: ['IsTruncated', deserializeBoolean],\n      KeyCount: ['KeyCount', deserializeNumber],\n      MaxKeys: ['MaxKeys', deserializeNumber],\n      Name: 'Name',\n      NextContinuationToken: 'NextContinuationToken',\n      Prefix: 'Prefix',\n      StartAfter: 'StartAfter'\n    });\n    const output = {\n      $metadata: parseMetadata(response),\n      ...contents\n    };\n    validateCorroboratingElements(output);\n    return output;\n  }\n};\nconst deserializeCommonPrefixList = output => output.map(deserializeCommonPrefix);\nconst deserializeCommonPrefix = output => map(output, {\n  Prefix: 'Prefix'\n});\nconst deserializeObjectList = output => output.map(deserializeObject);\nconst deserializeObject = output => map(output, {\n  Key: 'Key',\n  LastModified: ['LastModified', deserializeTimestamp],\n  ETag: 'ETag',\n  ChecksumAlgorithm: ['ChecksumAlgorithm', value => emptyArrayGuard(value, deserializeChecksumAlgorithmList)],\n  Size: ['Size', deserializeNumber],\n  StorageClass: 'StorageClass',\n  Owner: ['Owner', deserializeOwner]\n});\nconst deserializeChecksumAlgorithmList = output => output.map(entry => String(entry));\nconst deserializeOwner = output => map(output, {\n  DisplayName: 'DisplayName',\n  ID: 'ID'\n});\nconst validateCorroboratingElements = response => {\n  const {\n    IsTruncated,\n    KeyCount,\n    Contents = [],\n    CommonPrefixes = [],\n    NextContinuationToken\n  } = response;\n  const validTruncation = IsTruncated && !!NextContinuationToken || !IsTruncated && !NextContinuationToken;\n  const validNumberOfKeysReturned = KeyCount === Contents.length + CommonPrefixes.length;\n  if (!validTruncation || !validNumberOfKeysReturned) {\n    throw new IntegrityError();\n  }\n};\nconst listObjectsV2 = composeServiceApi(s3TransferHandler, listObjectsV2Serializer, listObjectsV2Deserializer, {\n  ...defaultConfig,\n  responseType: 'text'\n});\nexport { listObjectsV2 };","map":{"version":3,"names":["listObjectsV2Serializer","input","endpoint","headers","assignStringVariables","RequestPayer","ExpectedBucketOwner","query","ContinuationToken","delimiter","Delimiter","EncodingType","FetchOwner","MaxKeys","prefix","Prefix","StartAfter","url","AmplifyUrl","toString","search","AmplifyUrlSearchParams","method","listObjectsV2Deserializer","response","statusCode","error","parseXmlError","buildStorageServiceError","parsed","parseXmlBody","contents","map","CommonPrefixes","value","emptyArrayGuard","deserializeCommonPrefixList","Contents","deserializeObjectList","IsTruncated","deserializeBoolean","KeyCount","deserializeNumber","Name","NextContinuationToken","output","$metadata","parseMetadata","validateCorroboratingElements","deserializeCommonPrefix","deserializeObject","Key","LastModified","deserializeTimestamp","ETag","ChecksumAlgorithm","deserializeChecksumAlgorithmList","Size","StorageClass","Owner","deserializeOwner","entry","String","DisplayName","ID","validTruncation","validNumberOfKeysReturned","length","IntegrityError","listObjectsV2","composeServiceApi","s3TransferHandler","defaultConfig","responseType"],"sources":["C:\\Users\\lvsct\\Desktop\\bitcoin-prediction\\node_modules\\@aws-amplify\\storage\\src\\providers\\s3\\utils\\client\\s3data\\listObjectsV2.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { parseMetadata, } from '@aws-amplify/core/internals/aws-client-utils';\nimport { AmplifyUrl, AmplifyUrlSearchParams, } from '@aws-amplify/core/internals/utils';\nimport { composeServiceApi } from '@aws-amplify/core/internals/aws-client-utils/composers';\nimport { assignStringVariables, buildStorageServiceError, deserializeBoolean, deserializeNumber, deserializeTimestamp, emptyArrayGuard, map, parseXmlBody, s3TransferHandler, } from '../utils';\nimport { IntegrityError } from '../../../../../errors/IntegrityError';\nimport { defaultConfig, parseXmlError } from './base';\nconst listObjectsV2Serializer = (input, endpoint) => {\n    const headers = assignStringVariables({\n        'x-amz-request-payer': input.RequestPayer,\n        'x-amz-expected-bucket-owner': input.ExpectedBucketOwner,\n    });\n    const query = assignStringVariables({\n        'list-type': '2',\n        'continuation-token': input.ContinuationToken,\n        delimiter: input.Delimiter,\n        'encoding-type': input.EncodingType,\n        'fetch-owner': input.FetchOwner,\n        'max-keys': input.MaxKeys,\n        prefix: input.Prefix,\n        'start-after': input.StartAfter,\n    });\n    const url = new AmplifyUrl(endpoint.url.toString());\n    url.search = new AmplifyUrlSearchParams(query).toString();\n    return {\n        method: 'GET',\n        headers,\n        url,\n    };\n};\nconst listObjectsV2Deserializer = async (response) => {\n    if (response.statusCode >= 300) {\n        // error is always set when statusCode >= 300\n        const error = (await parseXmlError(response));\n        throw buildStorageServiceError(error, response.statusCode);\n    }\n    else {\n        const parsed = await parseXmlBody(response);\n        const contents = map(parsed, {\n            CommonPrefixes: [\n                'CommonPrefixes',\n                value => emptyArrayGuard(value, deserializeCommonPrefixList),\n            ],\n            Contents: [\n                'Contents',\n                value => emptyArrayGuard(value, deserializeObjectList),\n            ],\n            ContinuationToken: 'ContinuationToken',\n            Delimiter: 'Delimiter',\n            EncodingType: 'EncodingType',\n            IsTruncated: ['IsTruncated', deserializeBoolean],\n            KeyCount: ['KeyCount', deserializeNumber],\n            MaxKeys: ['MaxKeys', deserializeNumber],\n            Name: 'Name',\n            NextContinuationToken: 'NextContinuationToken',\n            Prefix: 'Prefix',\n            StartAfter: 'StartAfter',\n        });\n        const output = {\n            $metadata: parseMetadata(response),\n            ...contents,\n        };\n        validateCorroboratingElements(output);\n        return output;\n    }\n};\nconst deserializeCommonPrefixList = (output) => output.map(deserializeCommonPrefix);\nconst deserializeCommonPrefix = (output) => map(output, {\n    Prefix: 'Prefix',\n});\nconst deserializeObjectList = (output) => output.map(deserializeObject);\nconst deserializeObject = (output) => map(output, {\n    Key: 'Key',\n    LastModified: ['LastModified', deserializeTimestamp],\n    ETag: 'ETag',\n    ChecksumAlgorithm: [\n        'ChecksumAlgorithm',\n        value => emptyArrayGuard(value, deserializeChecksumAlgorithmList),\n    ],\n    Size: ['Size', deserializeNumber],\n    StorageClass: 'StorageClass',\n    Owner: ['Owner', deserializeOwner],\n});\nconst deserializeChecksumAlgorithmList = (output) => output.map(entry => String(entry));\nconst deserializeOwner = (output) => map(output, { DisplayName: 'DisplayName', ID: 'ID' });\nconst validateCorroboratingElements = (response) => {\n    const { IsTruncated, KeyCount, Contents = [], CommonPrefixes = [], NextContinuationToken, } = response;\n    const validTruncation = (IsTruncated && !!NextContinuationToken) ||\n        (!IsTruncated && !NextContinuationToken);\n    const validNumberOfKeysReturned = KeyCount === Contents.length + CommonPrefixes.length;\n    if (!validTruncation || !validNumberOfKeysReturned) {\n        throw new IntegrityError();\n    }\n};\nexport const listObjectsV2 = composeServiceApi(s3TransferHandler, listObjectsV2Serializer, listObjectsV2Deserializer, { ...defaultConfig, responseType: 'text' });\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}