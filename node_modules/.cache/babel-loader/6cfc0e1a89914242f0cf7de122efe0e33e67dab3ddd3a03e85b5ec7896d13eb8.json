{"ast":null,"code":"import '../../../../utils/client/s3data/base.mjs';\nimport '../../../../utils/client/s3data/getObject.mjs';\nimport '../../../../utils/client/s3data/listObjectsV2.mjs';\nimport '../../../../utils/client/s3data/putObject.mjs';\nimport { createMultipartUpload } from '../../../../utils/client/s3data/createMultipartUpload.mjs';\nimport '../../../../utils/client/s3data/uploadPart.mjs';\nimport '../../../../utils/client/s3data/completeMultipartUpload.mjs';\nimport '../../../../utils/client/s3data/listParts.mjs';\nimport '../../../../utils/client/s3data/abortMultipartUpload.mjs';\nimport '../../../../utils/client/s3data/copyObject.mjs';\nimport '../../../../utils/client/s3data/headObject.mjs';\nimport '../../../../utils/client/s3data/deleteObject.mjs';\nimport '../../../../../../errors/types/validation.mjs';\nimport '@aws-amplify/core/internals/utils';\nimport { logger } from '../../../../../../utils/logger.mjs';\nimport { constructContentDisposition } from '../../../../utils/constructContentDisposition.mjs';\nimport { CHECKSUM_ALGORITHM_CRC32 } from '../../../../utils/constants.mjs';\nimport { getCombinedCrc32 } from '../../../../utils/getCombinedCrc32.native.mjs';\nimport { getUploadsCacheKey, findCachedUploadParts, cacheMultipartUpload } from './uploadCache.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n/**\n * Load the in-progress multipart upload from local storage or async storage(RN) if it exists, or create a new multipart\n * upload.\n *\n * @internal\n */\nconst loadOrCreateMultipartUpload = async _ref => {\n  let {\n    s3Config,\n    data,\n    size,\n    contentType,\n    bucket,\n    accessLevel,\n    keyPrefix,\n    key,\n    contentDisposition,\n    contentEncoding,\n    metadata,\n    abortSignal,\n    checksumAlgorithm,\n    optionsHash,\n    resumableUploadsCache,\n    expectedBucketOwner\n  } = _ref;\n  const finalKey = keyPrefix !== undefined ? keyPrefix + key : key;\n  let cachedUpload;\n  if (!resumableUploadsCache) {\n    logger.debug('uploaded cache instance cannot be determined, skipping cache.');\n    cachedUpload = undefined;\n  } else {\n    const uploadCacheKey = getUploadsCacheKey({\n      size,\n      contentType,\n      file: data instanceof File ? data : undefined,\n      bucket,\n      accessLevel,\n      key,\n      optionsHash\n    });\n    const cachedUploadParts = await findCachedUploadParts({\n      s3Config,\n      cacheKey: uploadCacheKey,\n      bucket,\n      finalKey,\n      resumableUploadsCache\n    });\n    cachedUpload = cachedUploadParts ? {\n      ...cachedUploadParts,\n      uploadCacheKey\n    } : undefined;\n  }\n  if (cachedUpload) {\n    return {\n      uploadId: cachedUpload.uploadId,\n      cachedParts: cachedUpload.parts,\n      finalCrc32: cachedUpload.finalCrc32\n    };\n  } else {\n    const finalCrc32 = checksumAlgorithm === CHECKSUM_ALGORITHM_CRC32 ? await getCombinedCrc32(data, size) : undefined;\n    const {\n      UploadId\n    } = await createMultipartUpload({\n      ...s3Config,\n      abortSignal\n    }, {\n      Bucket: bucket,\n      Key: finalKey,\n      ContentType: contentType,\n      ContentDisposition: constructContentDisposition(contentDisposition),\n      ContentEncoding: contentEncoding,\n      Metadata: metadata,\n      ChecksumAlgorithm: finalCrc32 ? 'CRC32' : undefined,\n      ExpectedBucketOwner: expectedBucketOwner\n    });\n    if (resumableUploadsCache) {\n      const uploadCacheKey = getUploadsCacheKey({\n        size,\n        contentType,\n        file: data instanceof File ? data : undefined,\n        bucket,\n        accessLevel,\n        key,\n        optionsHash\n      });\n      await cacheMultipartUpload(resumableUploadsCache, uploadCacheKey, {\n        uploadId: UploadId,\n        bucket,\n        key,\n        finalCrc32,\n        fileName: data instanceof File ? data.name : ''\n      });\n    }\n    return {\n      uploadId: UploadId,\n      cachedParts: [],\n      finalCrc32\n    };\n  }\n};\nexport { loadOrCreateMultipartUpload };","map":{"version":3,"names":["loadOrCreateMultipartUpload","_ref","s3Config","data","size","contentType","bucket","accessLevel","keyPrefix","key","contentDisposition","contentEncoding","metadata","abortSignal","checksumAlgorithm","optionsHash","resumableUploadsCache","expectedBucketOwner","finalKey","undefined","cachedUpload","logger","debug","uploadCacheKey","getUploadsCacheKey","file","File","cachedUploadParts","findCachedUploadParts","cacheKey","uploadId","cachedParts","parts","finalCrc32","CHECKSUM_ALGORITHM_CRC32","getCombinedCrc32","UploadId","createMultipartUpload","Bucket","Key","ContentType","ContentDisposition","constructContentDisposition","ContentEncoding","Metadata","ChecksumAlgorithm","ExpectedBucketOwner","cacheMultipartUpload","fileName","name"],"sources":["C:\\Users\\lvsct\\Desktop\\bitcoin-prediction\\node_modules\\@aws-amplify\\storage\\src\\providers\\s3\\apis\\internal\\uploadData\\multipart\\initialUpload.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { createMultipartUpload } from '../../../../utils/client/s3data';\nimport { logger } from '../../../../../../utils';\nimport { constructContentDisposition } from '../../../../utils/constructContentDisposition';\nimport { CHECKSUM_ALGORITHM_CRC32 } from '../../../../utils/constants';\nimport { getCombinedCrc32 } from '../../../../utils/getCombinedCrc32.native';\nimport { cacheMultipartUpload, findCachedUploadParts, getUploadsCacheKey, } from './uploadCache';\n/**\n * Load the in-progress multipart upload from local storage or async storage(RN) if it exists, or create a new multipart\n * upload.\n *\n * @internal\n */\nexport const loadOrCreateMultipartUpload = async ({ s3Config, data, size, contentType, bucket, accessLevel, keyPrefix, key, contentDisposition, contentEncoding, metadata, abortSignal, checksumAlgorithm, optionsHash, resumableUploadsCache, expectedBucketOwner, }) => {\n    const finalKey = keyPrefix !== undefined ? keyPrefix + key : key;\n    let cachedUpload;\n    if (!resumableUploadsCache) {\n        logger.debug('uploaded cache instance cannot be determined, skipping cache.');\n        cachedUpload = undefined;\n    }\n    else {\n        const uploadCacheKey = getUploadsCacheKey({\n            size,\n            contentType,\n            file: data instanceof File ? data : undefined,\n            bucket,\n            accessLevel,\n            key,\n            optionsHash,\n        });\n        const cachedUploadParts = await findCachedUploadParts({\n            s3Config,\n            cacheKey: uploadCacheKey,\n            bucket,\n            finalKey,\n            resumableUploadsCache,\n        });\n        cachedUpload = cachedUploadParts\n            ? { ...cachedUploadParts, uploadCacheKey }\n            : undefined;\n    }\n    if (cachedUpload) {\n        return {\n            uploadId: cachedUpload.uploadId,\n            cachedParts: cachedUpload.parts,\n            finalCrc32: cachedUpload.finalCrc32,\n        };\n    }\n    else {\n        const finalCrc32 = checksumAlgorithm === CHECKSUM_ALGORITHM_CRC32\n            ? await getCombinedCrc32(data, size)\n            : undefined;\n        const { UploadId } = await createMultipartUpload({\n            ...s3Config,\n            abortSignal,\n        }, {\n            Bucket: bucket,\n            Key: finalKey,\n            ContentType: contentType,\n            ContentDisposition: constructContentDisposition(contentDisposition),\n            ContentEncoding: contentEncoding,\n            Metadata: metadata,\n            ChecksumAlgorithm: finalCrc32 ? 'CRC32' : undefined,\n            ExpectedBucketOwner: expectedBucketOwner,\n        });\n        if (resumableUploadsCache) {\n            const uploadCacheKey = getUploadsCacheKey({\n                size,\n                contentType,\n                file: data instanceof File ? data : undefined,\n                bucket,\n                accessLevel,\n                key,\n                optionsHash,\n            });\n            await cacheMultipartUpload(resumableUploadsCache, uploadCacheKey, {\n                uploadId: UploadId,\n                bucket,\n                key,\n                finalCrc32,\n                fileName: data instanceof File ? data.name : '',\n            });\n        }\n        return {\n            uploadId: UploadId,\n            cachedParts: [],\n            finalCrc32,\n        };\n    }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AACY,MAACA,2BAA2B,GAAG,MAAAC,IAAA,IAA+N;EAAA,IAAxN;IAAEC,QAAQ;IAAEC,IAAI;IAAEC,IAAI;IAAEC,WAAW;IAAEC,MAAM;IAAEC,WAAW;IAAEC,SAAS;IAAEC,GAAG;IAAEC,kBAAkB;IAAEC,eAAe;IAAEC,QAAQ;IAAEC,WAAW;IAAEC,iBAAiB;IAAEC,WAAW;IAAEC,qBAAqB;IAAEC;EAAmB,CAAG,GAAAhB,IAAA;EACjQ,MAAMiB,QAAQ,GAAGV,SAAS,KAAKW,SAAS,GAAGX,SAAS,GAAGC,GAAG,GAAGA,GAAG;EAChE,IAAIW,YAAY;EAChB,IAAI,CAACJ,qBAAqB,EAAE;IACxBK,MAAM,CAACC,KAAK,CAAC,+DAA+D,CAAC;IAC7EF,YAAY,GAAGD,SAAS;EAChC,CAAK,MACI;IACD,MAAMI,cAAc,GAAGC,kBAAkB,CAAC;MACtCpB,IAAI;MACJC,WAAW;MACXoB,IAAI,EAAEtB,IAAI,YAAYuB,IAAI,GAAGvB,IAAI,GAAGgB,SAAS;MAC7Cb,MAAM;MACNC,WAAW;MACXE,GAAG;MACHM;IACZ,CAAS,CAAC;IACF,MAAMY,iBAAiB,GAAG,MAAMC,qBAAqB,CAAC;MAClD1B,QAAQ;MACR2B,QAAQ,EAAEN,cAAc;MACxBjB,MAAM;MACNY,QAAQ;MACRF;IACZ,CAAS,CAAC;IACFI,YAAY,GAAGO,iBAAiB,GAC1B;MAAE,GAAGA,iBAAiB;MAAEJ;IAAc,CAAE,GACxCJ,SAAS;EACvB;EACI,IAAIC,YAAY,EAAE;IACd,OAAO;MACHU,QAAQ,EAAEV,YAAY,CAACU,QAAQ;MAC/BC,WAAW,EAAEX,YAAY,CAACY,KAAK;MAC/BC,UAAU,EAAEb,YAAY,CAACa;IACrC,CAAS;EACT,CAAK,MACI;IACD,MAAMA,UAAU,GAAGnB,iBAAiB,KAAKoB,wBAAwB,GAC3D,MAAMC,gBAAgB,CAAChC,IAAI,EAAEC,IAAI,CAAC,GAClCe,SAAS;IACf,MAAM;MAAEiB;IAAQ,CAAE,GAAG,MAAMC,qBAAqB,CAAC;MAC7C,GAAGnC,QAAQ;MACXW;IACZ,CAAS,EAAE;MACCyB,MAAM,EAAEhC,MAAM;MACdiC,GAAG,EAAErB,QAAQ;MACbsB,WAAW,EAAEnC,WAAW;MACxBoC,kBAAkB,EAAEC,2BAA2B,CAAChC,kBAAkB,CAAC;MACnEiC,eAAe,EAAEhC,eAAe;MAChCiC,QAAQ,EAAEhC,QAAQ;MAClBiC,iBAAiB,EAAEZ,UAAU,GAAG,OAAO,GAAGd,SAAS;MACnD2B,mBAAmB,EAAE7B;IACjC,CAAS,CAAC;IACF,IAAID,qBAAqB,EAAE;MACvB,MAAMO,cAAc,GAAGC,kBAAkB,CAAC;QACtCpB,IAAI;QACJC,WAAW;QACXoB,IAAI,EAAEtB,IAAI,YAAYuB,IAAI,GAAGvB,IAAI,GAAGgB,SAAS;QAC7Cb,MAAM;QACNC,WAAW;QACXE,GAAG;QACHM;MAChB,CAAa,CAAC;MACF,MAAMgC,oBAAoB,CAAC/B,qBAAqB,EAAEO,cAAc,EAAE;QAC9DO,QAAQ,EAAEM,QAAQ;QAClB9B,MAAM;QACNG,GAAG;QACHwB,UAAU;QACVe,QAAQ,EAAE7C,IAAI,YAAYuB,IAAI,GAAGvB,IAAI,CAAC8C,IAAI,GAAG;MAC7D,CAAa,CAAC;IACd;IACQ,OAAO;MACHnB,QAAQ,EAAEM,QAAQ;MAClBL,WAAW,EAAE,EAAE;MACfE;IACZ,CAAS;EACT;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}